<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Classroom Collaboration · Teacher</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link href="/css/teacher.css" rel="stylesheet">
  </head>
  <body>
    <div class="bg"></div>

    <header class="site-header">
      <div class="brand">
        <span class="logo">CC</span>
        <span class="title">Classroom Collaboration</span>
        <span class="role">Teacher</span>
      </div>
    </header>

    <main class="wrap">
      <!-- 房间 & 二维码 -->
      <section class="card" id="roomCard">
        <h2 class="card-title">Room & QR</h2>
        <div class="room-grid">
          <div>
            <label class="label" for="roomCode">Room Code</label>
            <div class="room-row">
              <input class="input room-input" id="roomCode" maxlength="8" placeholder="e.g. ABC123">
              <button id="genRoom" class="btn">Generate</button>
              <button id="applyRoom" class="btn btn-primary">Apply</button>
            </div>
            <p class="muted">Students can join via code <b id="roomCodeText">—</b> or scan the QR.</p>
            <p class="muted small">Join URL: <span id="joinUrl">—</span></p>
          </div>
          <div class="qr-box">
            <canvas id="qrCanvas" width="160" height="160" aria-label="Room QR"></canvas>
          </div>
        </div>
      </section>

      <!-- 题型选择 -->
      <section id="gameSelection" class="card">
        <h2 class="card-title">Select a question type</h2>
        <div class="btn-row">
          <button id="shortAnswer" class="btn btn-primary">Short Answer</button>
          <button id="trueFalse" class="btn">True / False</button>
        </div>
      </section>

      <!-- 简答题 -->
      <section id="short" class="card hidden" aria-hidden="true">
        <h2 class="card-title">Short Answer</h2>
        <form id="shortQuestion" class="form-grid" action="">
          <label class="label" for="question">Question</label>
          <input class="input" type="text" id="question" placeholder="Type your question..." required>

          <label class="label" for="answer">Correct Answer</label>
          <input class="input" type="text" id="answer" placeholder="Type the correct answer..." required>

          <label class="label" for="timeLimit">Time Limit <span class="hint">(10–90s)</span></label>
          <input class="range" type="range" step="5" min="10" max="90" id="timeLimit" value="30">
          <div class="range-ticks"><span>10s</span><span>50s</span><span>90s</span></div>

          <div class="btn-row">
            <input id="submit" class="btn btn-primary" type="submit" value="Send Question">
            <button type="button" class="btn btn-ghost" id="cancelShort">Cancel</button>
          </div>
        </form>
      </section>

      <!-- 判断题 -->
      <section id="truefalse" class="card hidden" aria-hidden="true">
        <h2 class="card-title">True / False</h2>
        <form id="trueFalseQuestion" class="form-grid" action="">
          <label class="label" for="tfquestion">Question</label>
          <input class="input" type="text" id="tfquestion" placeholder="Type your statement..." required>

          <span class="label">Correct Answer</span>
          <div class="radio-row">
            <label class="radio"><input type="radio" name="tfanswer" value="true"> True</label>
            <label class="radio"><input type="radio" name="tfanswer" value="false"> False</label>
          </div>

          <label class="label" for="tftimeLimit">Time Limit <span class="hint">(10–90s)</span></label>
          <input class="range" type="range" step="5" min="10" max="90" id="tftimeLimit" value="30">
          <div class="range-ticks"><span>10s</span><span>50s</span><span>90s</span></div>

          <div class="btn-row">
            <input id="tfsubmit" class="btn btn-primary" type="submit" value="Send Question">
            <button type="button" class="btn btn-ghost" id="cancelTF">Cancel</button>
          </div>
        </form>
      </section>

      <!-- 线下答题录入 -->
      <section class="card" id="offlineCard">
        <h2 class="card-title">Add Offline Answers</h2>
        <div class="muted small">Record paper-based answers to update the leaderboard.</div>
        <form id="offlineForm">
          <div id="offlineRows"></div>
          <div class="btn-row">
            <button type="button" id="addRow" class="btn">+ Add Row</button>
            <button type="submit" class="btn btn-primary">Submit Offline Results</button>
          </div>
        </form>
      </section>

      <!-- 统计 + 排行榜 -->
      <section id="gameSummary" class="card hidden" aria-live="polite">
        <div class="summary-header">
          <h2 class="card-title">Live Summary</h2>
          <button id="reset" class="btn">Submit Another Question</button>
        </div>

        <div class="stats">
          <div class="stat">
            <div class="stat-value" id="totalAnswers">0</div>
            <div class="stat-label">Total</div>
          </div>
          <div class="stat ok">
            <div class="stat-value" id="correctAnswers">0</div>
            <div class="stat-label">Correct</div>
          </div>
          <div class="stat warn">
            <div class="stat-value" id="incorrectAnswers">0</div>
            <div class="stat-label">Incorrect</div>
          </div>
          <div class="stat pill">
            <div class="stat-value" id="correctAverage">0%</div>
            <div class="stat-label">Accuracy</div>
          </div>
        </div>

        <div class="lists">
          <div>
            <h3>Correct Users</h3>
            <p id="correctUsers" class="mono">—</p>
          </div>
          <div>
            <h3>Incorrect Users</h3>
            <p id="incorrectUsers" class="mono">—</p>
          </div>
        </div>

        <h3 style="margin-top:12px;">Leaderboard</h3>
        <table class="table" id="leaderboard">
          <thead>
            <tr><th>#</th><th>User</th><th>Score</th><th>Correct</th><th>Avg Time (s)</th></tr>
          </thead>
          <tbody></tbody>
        </table>

        <div class="progress">
          <div id="timerBar" class="progress-bar" style="width:0%"></div>
        </div>
        <p id="timer" class="timer-text"></p>
      </section>
    </main>

    <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script src="/js/teacher.js"></script>
  </body>
</html>
