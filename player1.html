<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Street Challenge · Player 1 (Host)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>


  <link href="/css/player1.css" rel="stylesheet">

  <!-- New Theme 2 code Load the new v2 CSS only when ?theme=v2 -->
  <script>
    (function(){
      const params = new URLSearchParams(location.search);
      if (params.get('theme') === 'v2') {
        const link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = '/css/player1_v2.css?v=dev1'; 
        document.head.appendChild(link);
        console.log('[Theme] player1_v2.css loaded');
      }
    })();
  </script>
    <!-- New Theme 2 code Load the new v2 CSS only when ?theme=v2 -->
</head>

<body>
  <header class="site-header">
    <div class="brand">
      <span class="logo">CC</span>
      <span class="title">Street Challenge</span>
      <span class="role">Host</span>
    </div>
  </header>

  <main class="wrap">
    <!-- ===== Step 1: Lobby ===== -->
    <section id="lobby" class="card">
      <h2 class="card-title">Lobby</h2>
      <div class="form-grid">
        <label class="label">Room Code</label>
        <div class="room-row">
          <input id="roomCode" class="input room-input" maxlength="8" placeholder="e.g. ABC123"/>
          <button id="genRoom" class="btn">Generate</button>
          <button id="applyRoom" class="btn btn-primary">Apply</button>
        </div>
        <p class="small muted">After Apply, you will enter the stage to choose questions and monitor audience support.</p>
      </div>
    </section>

    <!-- ===== Step 2: Stage ===== -->
    <section class="card">
      <h2 class="card-title">Share</h2>
      <div>
        <p class="small">Current code: <b id="roomCodeText">—</b></p>
      </div>
    </section>

      <!-- Live Votes -->
      <section class="card">
        <h2 class="card-title">Live Votes</h2>
        <div class="between">
          <span class="muted small">Real-time votes from Audience</span>
          <span id="voteStat1" class="small">👍 0 | 👎 0 (0% up)</span>
        </div>
        <div class="bar" style="margin-top:8px">
          <div id="voteBarUp1" class="up" style="width:0%"></div>
        </div>
      </section>

      <!-- Street Challenge (Question Preview) -->
      <section class="card" id="bankCard">
        <h2 class="card-title">Street Challenge - Auto Mode</h2>
        <div class="form-grid">
          <label class="label">Select Category</label>
          <select id="bankCategory" class="input" style="max-width:300px"></select>

          <label class="label">Time Limit (sec)</label>
          <input id="bankTime" type="number" class="input" min="5" value="30" style="max-width:120px"/>

          <p id="categoryInfo" class="small muted">—</p>

          <div class="btn-row">
            <button id="startQuiz" class="btn btn-primary">Start Quiz</button>
          </div>

          <p class="small muted">
            📋 Questions will be randomly selected automatically. 
            The quiz will advance to the next question when a player submits or time runs out.
          </p>
        </div>

        <!-- Question Preview Table -->
        <div class="table-wrap" style="margin-top:16px">
          <h3 class="small" style="margin-bottom:8px; color: var(--muted)">Question Preview (Read-only)</h3>
          <table class="table" id="bankTable">
            <thead>
              <tr>
                <th style="width:60px">#</th>
                <th>Claim</th>
                <th style="width:100px">Answer</th>
                <th style="width:100px">Status</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <!-- Summary & Leaderboard (During Quiz) -->
      <section id="gameSummary" class="card hidden">
        <h2 class="card-title">
          Live Summary & Leaderboard 
          <span id="qNo" class="small muted" style="margin-left:8px">Q — / —</span>
        </h2>
        <div class="stats">
          <div class="stat"><div id="totalAnswers" class="stat-value">0</div><div class="stat-label">Total Answers</div></div>
          <div class="stat"><div id="correctAnswers" class="stat-value">0</div><div class="stat-label">Believed True</div></div>
          <div class="stat"><div id="incorrectAnswers" class="stat-value">0</div><div class="stat-label">Believed False</div></div>
          <div class="stat"><div id="correctAverage" class="stat-value">0%</div><div class="stat-label">True Share</div></div>
        </div>
        <div class="progress"><div id="timerBar" class="progress-bar"></div></div>
        <div class="timer-text">
          Time left: <span id="timer" class="mono"></span>
          <span class="small muted" style="margin-left:12px">⚡ Auto-advancing...</span>
        </div>

        <div class="lists" style="margin-top:12px">
          <div><h3 class="list-title">True</h3><div id="correctUsers" class="input" style="min-height:48px"></div></div>
          <div><h3 class="list-title">False</h3><div id="incorrectUsers" class="input" style="min-height:48px"></div></div>
        </div>

        <div class="table-wrap" style="margin-top:12px">
          <table id="leaderboard" class="table">
            <thead><tr><th>#</th><th>Name</th><th>Score</th><th>Correct</th><th>Avg(s)</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <!-- Completion Page -->
      <section id="completionPage" class="card hidden completion-card">
        <div class="completion-header">
          <h1 id="completionTitle" class="completion-title">🎉 Quiz Completed!</h1>
          <p id="completionMessage" class="completion-message">—</p>
        </div>

        <div class="card" style="margin-top:20px">
          <h2 class="card-title">🏆 Final Leaderboard</h2>
          <div class="table-wrap">
            <table id="completionLeaderboard" class="table">
              <thead><tr><th>#</th><th>Name</th><th>Score</th><th>Correct</th><th>Avg(s)</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <div class="btn-row" style="margin-top:20px">
          <button id="newRound" class="btn btn-primary">Start New Round (Reset Category)</button>
        </div>
      </section>
    </section>
  </main>

  <!-- libs -->
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
  <script src="/env.js"></script>
  <!-- module -->
  <script type="module" src="/js/player1.js"></script>
</body>
</html>